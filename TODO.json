{
  "partialReReadAutoRetry": {
    "currentStatus": {
      "infrastructure": [
        "affectedRanges returned in edit tool errors on hash mismatch",
        "ranges parameter defined in read tool schema"
      ],
      "missing": [
        "Agent session only steers user message instead of auto-triggering",
        "No automatic retry mechanism"
      ]
    },
    "beadsStructure": {
      "epic": "oh-my-pi-wip-partial-re-read",
      "tasks": [
        {
          "id": "oh-my-pi-wip-audit",
          "content": "Audit: Verify current partial re-read state",
          "type": "audit",
          "status": "pending"
        },
        {
          "id": "oh-my-pi-wip-design",
          "content": "Design: Auto-retry architecture",
          "type": "design",
          "status": "pending"
        },
        {
          "id": "oh-my-pi-wip-impl-read",
          "content": "Implementation: Add ranges support to read tool",
          "type": "implementation",
          "status": "completed"
        },
        {
          "id": "oh-my-pi-wip-impl-agent",
          "content": "Implementation: Add auto-trigger to agent session",
          "type": "implementation",
          "status": "pending"
        },
        {
          "id": "oh-my-pi-wip-wiring",
          "content": "Wiring: Connect edit errors to auto re-read",
          "type": "wiring",
          "status": "pending"
        },
        {
          "id": "oh-my-pi-wip-test",
          "content": "Tests: Auto re-read scenario tests",
          "type": "testing",
          "status": "pending"
        },
        {
          "id": "oh-my-pi-wip-docs",
          "content": "Documentation: Update partial re-read docs",
          "type": "docs",
          "status": "pending"
        }
      ]
    },
    "branchStrategy": {
      "branch": "epic/wip-partial-re-read",
      "lifecycle": "Merge after completion",
      "protection": "PR required, CI must pass"
    },
    "commitSliceStrategy": [
      {
        "commit": "audit(patch): verify partial re-read current state",
        "changes": [
          "Document current gaps",
          "Define auto-retry requirements"
        ]
      },
      {
        "commit": "design(patch): define auto-retry architecture",
        "changes": [
          "Agent session error handling flow",
          "Read tool ranges implementation plan"
        ]
      },
      {
        "commit": "feat(tools): implement ranges parameter in read tool",
        "changes": [
          "Handle ranges array in execute method",
          "Convert ranges to offset/limit for streaming",
          "Support multiple non-contiguous ranges",
          "Add validation and error handling"
        ]
      },
      {
        "commit": "feat(session): add auto-re-read trigger for hash mismatches",
        "changes": [
          "Replace steering message with actual read tool call",
          "Handle read tool response and context update",
          "Add retry logic with fresh hashlines"
        ]
      },
      {
        "commit": "wiring(patch): connect edit errors to auto re-read",
        "changes": [
          "Integrate read tool ranges with agent session",
          "Handle edge cases (concurrent edits, failures)",
          "Update context with fresh hashlines"
        ]
      },
      {
        "commit": "test(patch): add auto re-read scenario tests",
        "changes": [
          "Hash mismatch triggers auto re-read",
          "Multiple ranges handled correctly",
          "Retry succeeds with fresh hashlines",
          "Edge cases covered"
        ]
      },
      {
        "commit": "docs(patch): update partial re-read documentation",
        "changes": [
          "Update partial-re-read-complete.md",
          "Add auto-retry section",
          "Document new behavior"
        ]
      }
    ],
    "acceptanceCriteria": [
      "Edit tool hash mismatch automatically triggers read with affected ranges",
      "Read tool accepts and processes ranges parameter correctly",
      "Agent session updates context with fresh hashlines",
      "Edit automatically retries with updated hashlines",
      "All existing tests continue to pass",
      "New scenario tests cover auto-retry flow",
      "Documentation updated"
    ],
    "implementationFiles": {
      "modified": [
        "packages/coding-agent/src/tools/read.ts",
        "packages/coding-agent/src/session/agent-session.ts",
        "packages/coding-agent/src/patch/index.ts"
      ],
      "newTests": [
        "packages/coding-agent/test/partial-re-read-auto.test.ts"
      ]
    },
    "timelineEstimate": {
      "total": "3-5 days",
      "phases": {
        "phase1": {
          "days": "Days 1-2",
          "focus": "Read tool ranges implementation"
        },
        "phase2": {
          "days": "Days 2-3",
          "focus": "Agent session auto-trigger"
        },
        "phase3": {
          "days": "Days 3-4",
          "focus": "Wiring and integration"
        },
        "phase4": {
          "days": "Days 4-5",
          "focus": "Testing and documentation"
        }
      }
    },
    "completedTasks": [
      {
        "id": "oh-my-pi-wip-impl-read",
        "content": "Implementation: Add ranges support to read tool",
        "type": "implementation",
        "status": "completed",
        "completedIn": "main branch",
        "commit": "74adbf9d",
        "completedDate": "2026-02-23"
      }
    ]
  }
}